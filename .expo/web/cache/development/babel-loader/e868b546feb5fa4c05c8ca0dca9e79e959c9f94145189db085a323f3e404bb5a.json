{"ast":null,"code":"var log = require(\"./logger\")(),\n  config = require(\"../config/config.js\"),\n  users = require(\"../models/user.server.models\");\nvar isAuthenticated = function isAuthenticated(req, res, next) {\n  var token = req.get(config.get('authToken'));\n  log.debug(\"authenticating \" + token);\n  users.getIdFromToken(token, function (err, id) {\n    if (err || id === null) {\n      log.warn(\"rejected auth attempt for token \" + token);\n      return res.sendStatus(401);\n    }\n    next();\n  });\n};\nmodule.exports = {\n  isAuthenticated: isAuthenticated\n};","map":{"version":3,"names":["log","require","config","users","isAuthenticated","req","res","next","token","get","debug","getIdFromToken","err","id","warn","sendStatus","module","exports"],"sources":["C:/Users/bahvd/source/repos/mobileapp/app/lib/middleware.js"],"sourcesContent":["const\r\n    log = require('./logger')(),\r\n    config = require('../config/config.js'),\r\n    users = require('../models/user.server.models');\r\n\r\n/**\r\n * authenticate based on token\r\n */\r\nconst isAuthenticated = function(req, res, next){\r\n  let token = req.get(config.get('authToken'));\r\n  log.debug(`authenticating ${token}`);\r\n  \r\n  users.getIdFromToken(token, (err, id) => {\r\n    if (err || id === null) {\r\n      log.warn(`rejected auth attempt for token ${token}`);\r\n      return res.sendStatus(401);\r\n    }\r\n\r\n    next();\r\n  });\r\n\r\n};\r\n\r\nmodule.exports = {\r\n    isAuthenticated: isAuthenticated\r\n};"],"mappings":"AAAA,IACIA,GAAG,GAAGC,OAAO,YAAY,EAAE;EAC3BC,MAAM,GAAGD,OAAO,uBAAuB;EACvCE,KAAK,GAAGF,OAAO,gCAAgC;AAKnD,IAAMG,eAAe,GAAG,SAAlBA,eAAeA,CAAYC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAC;EAC9C,IAAIC,KAAK,GAAGH,GAAG,CAACI,GAAG,CAACP,MAAM,CAACO,GAAG,CAAC,WAAW,CAAC,CAAC;EAC5CT,GAAG,CAACU,KAAK,qBAAmBF,KAAK,CAAG;EAEpCL,KAAK,CAACQ,cAAc,CAACH,KAAK,EAAE,UAACI,GAAG,EAAEC,EAAE,EAAK;IACvC,IAAID,GAAG,IAAIC,EAAE,KAAK,IAAI,EAAE;MACtBb,GAAG,CAACc,IAAI,sCAAoCN,KAAK,CAAG;MACpD,OAAOF,GAAG,CAACS,UAAU,CAAC,GAAG,CAAC;IAC5B;IAEAR,IAAI,EAAE;EACR,CAAC,CAAC;AAEJ,CAAC;AAEDS,MAAM,CAACC,OAAO,GAAG;EACbb,eAAe,EAAEA;AACrB,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}